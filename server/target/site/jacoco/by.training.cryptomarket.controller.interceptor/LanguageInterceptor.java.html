<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>LanguageInterceptor.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">server</a> &gt; <a href="index.source.html" class="el_package">by.training.cryptomarket.controller.interceptor</a> &gt; <span class="el_source">LanguageInterceptor.java</span></div><h1>LanguageInterceptor.java</h1><pre class="source lang-java linenums">package by.training.cryptomarket.controller.interceptor;



import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.PropertySource;
import org.springframework.core.env.Environment;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContext;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Component;
import org.springframework.ui.ModelMap;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.handler.HandlerInterceptorAdapter;

import javax.servlet.ServletConfig;
import javax.servlet.ServletContext;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.util.HashMap;
import java.util.Locale;
import java.util.Properties;
import java.util.ResourceBundle;


<span class="fc" id="L27">public class LanguageInterceptor extends HandlerInterceptorAdapter {</span>





    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {


<span class="nc" id="L37">     HttpServletRequest httpRequest =  request;</span>
<span class="nc" id="L38">     HttpSession session = httpRequest.getSession();</span>

<span class="nc bnc" id="L40" title="All 4 branches missed.">     if ((session != null &amp;&amp; session.getAttribute(&quot;language&quot;) == null)) {</span>
<span class="nc" id="L41">      httpRequest.getSession().setAttribute(&quot;language&quot;, &quot;en&quot;);</span>
     }



<span class="nc" id="L46">           Locale locale = new Locale((String) httpRequest.getSession().getAttribute(&quot;language&quot;));</span>
<span class="nc" id="L47">            ResourceBundle resourceBundle = ResourceBundle.getBundle(&quot;text&quot;, locale);</span>
<span class="nc" id="L48">            modelAndView.addObject(&quot;login&quot;, resourceBundle.getString(&quot;button.login&quot;));</span>
<span class="nc" id="L49">            modelAndView.addObject(&quot;registration&quot;, resourceBundle.getString(&quot;button.registration&quot;));</span>
<span class="nc" id="L50">            modelAndView.addObject(&quot;logout&quot;, resourceBundle.getString(&quot;button.logout&quot;));</span>
<span class="nc" id="L51">            modelAndView.addObject(&quot;approve&quot;, resourceBundle.getString(&quot;button.approve&quot;));</span>
<span class="nc" id="L52">            modelAndView.addObject(&quot;cabinet&quot;, resourceBundle.getString(&quot;button.cabinet&quot;));</span>
<span class="nc" id="L53">            modelAndView.addObject(&quot;reject&quot;, resourceBundle.getString(&quot;button.reject&quot;));</span>
<span class="nc" id="L54">            modelAndView.addObject(&quot;toggle&quot;, resourceBundle.getString(&quot;button.toggle&quot;));</span>
<span class="nc" id="L55">            modelAndView.addObject(&quot;myorders&quot;, resourceBundle.getString(&quot;button.myorders&quot;));</span>
<span class="nc" id="L56">            modelAndView.addObject(&quot;mywallet&quot;, resourceBundle.getString(&quot;button.mywallet&quot;));</span>
<span class="nc" id="L57">            modelAndView.addObject(&quot;market&quot;, resourceBundle.getString(&quot;button.market&quot;));</span>
<span class="nc" id="L58">            modelAndView.addObject(&quot;buy&quot;, resourceBundle.getString(&quot;button.buy&quot;));</span>
<span class="nc" id="L59">            modelAndView.addObject(&quot;sell&quot;, resourceBundle.getString(&quot;button.sell&quot;));</span>
<span class="nc" id="L60">            modelAndView.addObject(&quot;cancel&quot;, resourceBundle.getString(&quot;button.cancel&quot;));</span>
<span class="nc" id="L61">            modelAndView.addObject(&quot;deposit&quot;, resourceBundle.getString(&quot;button.deposit&quot;));</span>
<span class="nc" id="L62">            modelAndView.addObject(&quot;withdraw&quot;, resourceBundle.getString(&quot;button.withdraw&quot;));</span>
<span class="nc" id="L63">            modelAndView.addObject(&quot;amount&quot;, resourceBundle.getString(&quot;text.amount&quot;));</span>

<span class="nc" id="L65">            modelAndView.addObject(&quot;username&quot;, resourceBundle.getString(&quot;text.username&quot;));</span>
<span class="nc" id="L66">            modelAndView.addObject(&quot;name&quot;, resourceBundle.getString(&quot;text.name&quot;));</span>
<span class="nc" id="L67">            modelAndView.addObject(&quot;surname&quot;, resourceBundle.getString(&quot;text.surname&quot;));</span>
<span class="nc" id="L68">            modelAndView.addObject(&quot;password&quot;, resourceBundle.getString(&quot;text.password&quot;));</span>

<span class="nc" id="L70">            modelAndView.addObject(&quot;administrator&quot;, resourceBundle.getString(&quot;text.administrator&quot;));</span>

<span class="nc" id="L72">            modelAndView.addObject(&quot;sec&quot;, resourceBundle.getString(&quot;text.sec&quot;));</span>

<span class="nc" id="L74">            modelAndView.addObject(&quot;usertext&quot;, resourceBundle.getString(&quot;text.usertext&quot;));</span>

<span class="nc" id="L76">            modelAndView.addObject(&quot;ask&quot;, resourceBundle.getString(&quot;text.ask&quot;));</span>
<span class="nc" id="L77">            modelAndView.addObject(&quot;bid&quot;, resourceBundle.getString(&quot;text.bid&quot;));</span>
<span class="nc" id="L78">            modelAndView.addObject(&quot;volume&quot;, resourceBundle.getString(&quot;text.volume&quot;));</span>
<span class="nc" id="L79">            modelAndView.addObject(&quot;price&quot;, resourceBundle.getString(&quot;text.price&quot;));</span>

<span class="nc" id="L81">            modelAndView.addObject(&quot;cryptocurrencymarket&quot;, resourceBundle.getString(&quot;text.cryptocurrencymarket&quot;));</span>

<span class="nc" id="L83">            modelAndView.addObject(&quot;applicationfordw&quot;, resourceBundle.getString(&quot;text.applicationfordw&quot;));</span>

<span class="nc" id="L85">            modelAndView.addObject(&quot;accessiblemarkets&quot;, resourceBundle.getString(&quot;text.accessiblemarkets&quot;));</span>






<span class="nc" id="L92">            HashMap&lt;String, String&gt; orderState = new HashMap&lt;&gt;();</span>
<span class="nc" id="L93">            orderState.put(&quot;executed&quot;, resourceBundle.getString(&quot;text.executed&quot;));</span>
<span class="nc" id="L94">            orderState.put(&quot;canceled&quot;, resourceBundle.getString(&quot;text.canceled&quot;));</span>
<span class="nc" id="L95">            orderState.put(&quot;active&quot;, resourceBundle.getString(&quot;text.active&quot;));</span>

<span class="nc" id="L97">            HashMap&lt;String, String&gt; transactionType = new HashMap&lt;&gt;();</span>
<span class="nc" id="L98">            transactionType.put(&quot;withdraw&quot;, resourceBundle.getString(&quot;button.withdraw&quot;));</span>
<span class="nc" id="L99">            transactionType.put(&quot;deposit&quot;, resourceBundle.getString(&quot;button.deposit&quot;));</span>

<span class="nc" id="L101">            HashMap&lt;String, String&gt; transactionStatus = new HashMap&lt;&gt;();</span>
<span class="nc" id="L102">            transactionStatus.put(&quot;pending&quot;, resourceBundle.getString(&quot;text.pending&quot;));</span>
<span class="nc" id="L103">            transactionStatus.put(&quot;approved&quot;, resourceBundle.getString(&quot;text.approved&quot;));</span>
<span class="nc" id="L104">            transactionStatus.put(&quot;rejected&quot;, resourceBundle.getString(&quot;text.rejected&quot;));</span>

<span class="nc" id="L106">            HashMap&lt;String, String&gt; loginFailed = new HashMap&lt;&gt;();</span>
<span class="nc" id="L107">            loginFailed.put(&quot;loginfailed&quot;, resourceBundle.getString(&quot;text.loginfailed&quot;));</span>
<span class="nc" id="L108">            loginFailed.put(&quot;protection&quot;, resourceBundle.getString(&quot;text.protection&quot;));</span>
<span class="nc" id="L109">            loginFailed.put(&quot;successful&quot;, resourceBundle.getString(&quot;text.successful&quot;));</span>
<span class="nc" id="L110">            loginFailed.put(&quot;&quot;, &quot;&quot;);</span>


<span class="nc" id="L113">            HashMap&lt;String, String&gt; registrationFailed = new HashMap&lt;&gt;();</span>
<span class="nc" id="L114">            registrationFailed.put(&quot;allfield&quot;, resourceBundle.getString(&quot;text.allfield&quot;));</span>
<span class="nc" id="L115">            registrationFailed.put(&quot;useralredyexist&quot;, resourceBundle.getString(&quot;text.useralredyexist&quot;));</span>
<span class="nc" id="L116">            registrationFailed.put(&quot;jsinjection&quot;, resourceBundle.getString(&quot;text.jsinjection&quot;));</span>
<span class="nc" id="L117">            registrationFailed.put(&quot;&quot;, &quot;&quot;);</span>

<span class="nc" id="L119">            HashMap&lt;String, String&gt; transactionError = new HashMap&lt;&gt;();</span>
<span class="nc" id="L120">            transactionError.put(&quot;incorrectamount&quot;, resourceBundle.getString(&quot;text.incorrectamount&quot;));</span>
<span class="nc" id="L121">            transactionError.put(&quot;insufficientfunds&quot;, resourceBundle.getString(&quot;text.insufficientfunds&quot;));</span>
<span class="nc" id="L122">            transactionError.put(&quot;yourorderisaccepted&quot;, resourceBundle.getString(&quot;text.yourorderisaccepted&quot;));</span>
<span class="nc" id="L123">            transactionError.put(&quot;yourapplicationiscompleted&quot;, resourceBundle.getString(&quot;text.yourapplicationiscompleted&quot;));</span>
<span class="nc" id="L124">            transactionError.put(&quot;&quot;, &quot;&quot;);</span>

<span class="nc" id="L126">            HashMap&lt;String, String&gt; marketError = new HashMap&lt;&gt;();</span>
<span class="nc" id="L127">            marketError.put(&quot;marketerror&quot;, resourceBundle.getString(&quot;text.marketerror&quot;));</span>
<span class="nc" id="L128">            marketError.put(&quot;&quot;, &quot;&quot;);</span>

<span class="nc" id="L130">            HashMap&lt;String, String&gt; typeOfOrder = new HashMap&lt;&gt;();</span>
<span class="nc" id="L131">            typeOfOrder.put(&quot;limit&quot;, resourceBundle.getString(&quot;text.limit&quot;));</span>
<span class="nc" id="L132">            typeOfOrder.put(&quot;market&quot;, resourceBundle.getString(&quot;text.market&quot;));</span>


<span class="nc" id="L135">            modelAndView.addObject(&quot;orderState&quot;, orderState);</span>
<span class="nc" id="L136">            modelAndView.addObject(&quot;transactionType&quot;, transactionType);</span>
<span class="nc" id="L137">            modelAndView.addObject(&quot;transactionStatus&quot;, transactionStatus);</span>
<span class="nc" id="L138">            modelAndView.addObject(&quot;loginFailed&quot;, loginFailed);</span>
<span class="nc" id="L139">            modelAndView.addObject(&quot;registrationFailed&quot;, registrationFailed);</span>
<span class="nc" id="L140">            modelAndView.addObject(&quot;transactionError&quot;, transactionError);</span>
<span class="nc" id="L141">            modelAndView.addObject(&quot;marketError&quot;, marketError);</span>
<span class="nc" id="L142">            modelAndView.addObject(&quot;typeOfOrder&quot;, typeOfOrder);</span>




<span class="nc" id="L147">     Properties props = new Properties();</span>


     String version;
     String buildDate;

     try {

<span class="nc" id="L155">      props.load(request.getServletContext().getResourceAsStream(&quot;/WEB-INF/classes/build.properties&quot;));</span>
<span class="nc" id="L156">      version = props.getProperty(&quot;build.version&quot;);</span>
<span class="nc" id="L157">      buildDate = props.getProperty(&quot;build.date&quot;);</span>

<span class="nc" id="L159">     } catch (Exception e) {</span>

<span class="nc" id="L161">      version = &quot;-&quot;;</span>
<span class="nc" id="L162">      buildDate = &quot;-&quot;;;</span>
<span class="nc" id="L163">     }</span>


<span class="nc" id="L166">     modelAndView.addObject(&quot;buildVersion&quot;, version);</span>
<span class="nc" id="L167">     modelAndView.addObject(&quot;buildDate&quot;, buildDate);</span>



<span class="nc" id="L171">     super.postHandle(request, response, handler, modelAndView);</span>
<span class="nc" id="L172">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>